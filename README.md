# 花园城停车助手 v3

一款用于管理账号、查询/兑换停车券、管理车牌号，并支持备份与恢复的 macOS 应用。

本项目为个人学习与效率工具，核心目标是：把“账号/车牌/停车券兑换”这些操作整合到一个更顺手的桌面应用里。

## 功能概览

### 账号与停车券
- 添加账号 / 删除账号（带二次确认）
- 导入/导出账号 JSON
- 查询积分 / 查询停车券数量
- 兑换停车券（支持设置兑换数量）
- 一键执行全部账号任务（只处理“未处理”的账号）
- 每日自动重置处理状态
- 手机号重复检查（避免重复导入/重复添加）

### 车牌号与停车费窗口
- 车牌号管理（新增/删除/选择）
- 快速切换车牌号（主界面快捷菜单）
- 停车费详情窗口：复制链接 / 浏览器打开
- 详情窗口关闭后智能刷新停车券数量

### 设置（v3 优化）
- 基本设置 / 安全与备份 / 高级设置（分段式选项卡）
- 备份设置：备份目录、自动备份、最大备份文件数、最后备份时间
- 备份操作：立即备份、查看备份、导入/导出
- 高级设置：管理员秘钥解锁（秘钥：`Achord666`），并带“危险区”占位扩展

### About 作者页
- 头像展示（AsyncImage）
- 联系方式（Tel/Email）
- 底部链接按钮（项目地址/隐私条款/开源协议/赞助）
- 支持预设文案展示（不可编辑，可复制）

## 重要说明（请务必阅读）

### 使用范围与免责声明
本工具仅用于个人学习与效率提升。除基础的网络请求调用与界面管理外，未进行任何逆向破解行为。

请勿用于任何违规用途。若你下载或使用本项目代码/应用，请在法律与平台规则允许范围内使用。

### Token 机制（技术说明）
应用使用 Token 进行身份验证：
- 每个账号登录后会获得一个 Token
- Token 会在验证成功后自动保存
- 后续 API 请求会携带 Token
- Token 可能失效，应用会在需要时自动重新登录获取新 Token
- 请勿泄露 Token 与导出的账号数据

### 双接口策略
为提升稳定性，部分功能采用新旧双接口协作：
- 新接口优先
- 新接口失败时自动切换旧接口（兜底）

## 数据与安全
当前版本数据存储策略：
- 账号数据保存在本地 `UserDefaults`（JSON 编码），包含账号密码等敏感字段
- 暂未接入 Keychain / AES 加密

安全建议：
- 仅在可信设备上使用
- 不要分享导出的 JSON、备份文件
- 若你担心风险，可自行修改为 Keychain 存储后再使用

## 开发环境
- macOS
- Xcode（建议 Xcode 15 或更高）
- Swift / SwiftUI

## 本地运行（Debug）
1. 用 Xcode 打开 `tingche.xcodeproj`
2. 选择 Scheme 后直接 Run

如果遇到构建问题：
- Product -> Clean Build Folder
- 删除派生数据（可选）：`rm -rf ~/Library/Developer/Xcode/DerivedData/tingche-*`

## 打包发布（Release + DMG）

### 1) 生成 .app
推荐用 Xcode 的 `Product -> Archive` 导出 Release 构建产物（.app）。

### 2) 生成 DMG
项目外有脚本可用于打包 DMG（普通版/酷炫版）。

酷炫版 DMG 支持：
- 自定义背景图
- 图标摆位（App 与 Applications）
- Finder 窗口样式（隐藏工具栏/路径栏等）

建议将 DMG 作为 GitHub Releases 附件发布，而不是直接提交到仓库（避免仓库被大二进制文件膨胀）。

## 应用改名与图标
常见需要同时修改：
- Target -> General -> Display Name
- Build Settings -> Product Name
- Assets.xcassets -> AppIcon（务必是 App Icon 类型，且 Target 指向它）

## 联系方式
- 作者：Achord
- Email：achordchan@gmail.com
- Tel：13160235855

## TODO
- 文本格式批量导入（例如：账号-密码-停车券数量-今日是否获取）
